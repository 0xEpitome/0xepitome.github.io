<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=images/tanjiro-modified.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">Epitome&#39;s Realm - p3rf3ctr00tCTF official writeup</title>
<meta property="og:title" content=Epitome&#39;s&#32;Realm&#32;-&#32;p3rf3ctr00tCTF&#32;official&#32;writeup />
<meta name="twitter:title" content=Epitome&#39;s&#32;Realm&#32;-&#32;p3rf3ctr00tCTF&#32;official&#32;writeup />
<meta itemprop="name" content=Epitome&#39;s&#32;Realm&#32;-&#32;p3rf3ctr00tCTF&#32;official&#32;writeup />
<meta name="application-name" content=Epitome&#39;s&#32;Realm&#32;-&#32;p3rf3ctr00tCTF&#32;official&#32;writeup />
<meta property="og:site_name" content="" />


<meta name="description" content="Official writeups for challenges created for p3rf3ctr00t CTF 2024" />
<meta itemprop="description" content="Official writeups for challenges created for p3rf3ctr00t CTF 2024" />
<meta property="og:description" content="Official writeups for challenges created for p3rf3ctr00t CTF 2024" />
<meta name="twitter:description" content="Official writeups for challenges created for p3rf3ctr00t CTF 2024" />


<base href="//localhost:1313/posts/ctf-writeups/p3rf3ctr00t/" />
<link rel="canonical" href="//localhost:1313/posts/ctf-writeups/p3rf3ctr00t/" itemprop="url" />
<meta name="url" content="//localhost:1313/posts/ctf-writeups/p3rf3ctr00t/" />
<meta name="twitter:url" content="//localhost:1313/posts/ctf-writeups/p3rf3ctr00t/" />
<meta property="og:url" content="//localhost:1313/posts/ctf-writeups/p3rf3ctr00t/" />


<meta property="og:updated_time" content="2024-11-20T00:00:00Z" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='//localhost:1313/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />



  
    <meta name="twitter:site" content="@0xEpitome" />
    <meta name="twitter:creator" content="@0xEpitome" />

<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.135.0">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.94a339836f89f0d25f31980cb6b0631da21e20af128308747ce44e0525eb16ef.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5A5A5A;
        --link-color: #268BD2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #EEE;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9D9D9D;
        --link-color: #268BD2;
        --date-color: #9A9A9A;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #FFF;
        --code-background-color: #515151;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="//localhost:1313/">
                <img src="/images/tanjiro-modified.png" alt="brand image">
            </a>
        
        
            <a href="//localhost:1313/">
                <h1>Epitome&#39;s Realm</h1>
            </a>
        
    </h1>
    <p class="lead">
    SOC Analyst | CTF Player | Malware Analysis
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
            
                
                
            
            
                
                
            
                
                
                        
                            <li class="heading">
                                <a href="/about/">About</a>
                            </li>
                            
                    
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
                    <li class="heading">
                        <a href="/posts/">Posts</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="//localhost:1313/posts/ctf-writeups/p3rf3ctr00t/">p3rf3ctr00tCTF official writeup</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="//localhost:1313/posts/cryptominer/">Cryptominer Based Security Events in AWS</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="//localhost:1313/posts/ctf-writeups/knight24/">Knight 2024</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="//localhost:1313/posts/ctf-writeups/buckeye-2023/">Buckeye CTF 2023</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="//localhost:1313/posts/ctf-writeups/uiuctf/">UIUCTF 2023</a>
                            </li>
                        
                    
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/0xEpitome">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>





    <a target="_blank" class="social" title="X" href="https://x.com/0xEpitome">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.1em" height="1.1em" viewBox="0 0 512 472.799">
            <path fill="currentColor" d="M403.229 0h78.506L310.219 196.04 512 462.799H354.002L230.261 301.007 88.669 462.799h-78.56l183.455-209.683L0 0h161.999l111.856 147.88L403.229 0zm-27.556 415.805h43.505L138.363 44.527h-46.68l283.99 371.278z"/>
        </svg>
    </a>




    <a target="_blank" class="social" title="HackTheBox" href="https://app.hackthebox.com/profile/1259902">
        <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="1.4em" viewBox="0 0 24 24">
            <path fill="currentColor" d="m22.51 6.457l.001-.013a.9.9 0 0 0-.271-.638l-.027-.024q-.028-.025-.057-.048q-.03-.022-.06-.04l-.029-.02l-9.61-5.547a.89.89 0 0 0-.922.004L1.933 5.674l-.03.02l-.023.014l-.02.015a1 1 0 0 0-.147.134l-.003.003a.9.9 0 0 0-.221.584v.014l-.001.027v11.07c0 .328.18.63.469.784l9.599 5.542l.023.011a1 1 0 0 0 .166.07l.04.01l.072.015l.035.006a.8.8 0 0 0 .216 0q.018-.002.035-.006l.072-.014l.04-.012l.064-.022a1 1 0 0 0 .102-.047l.023-.011l9.599-5.542a.89.89 0 0 0 .469-.784V6.478zM5.255 6.082l6.537-3.774a.42.42 0 0 1 .418 0l6.537 3.774a.418.418 0 0 1 0 .725l-6.537 3.774a.42.42 0 0 1-.418 0L5.254 6.807a.418.418 0 0 1 0-.725m5.614 14.345a.417.417 0 0 1-.626.361l-6.524-3.766a.42.42 0 0 1-.209-.361V9.127a.417.417 0 0 1 .626-.361l6.524 3.766a.42.42 0 0 1 .209.362zm9.623-3.766a.42.42 0 0 1-.209.36l-6.524 3.767a.417.417 0 0 1-.626-.36v-7.533c0-.15.08-.287.209-.362l6.524-3.766a.417.417 0 0 1 .626.36z"/>
        </svg>
    </a>


    <a target="_blank" class="social" title="TryHackMe" href="https://tryhackme.com/r/p/0x3pitom3">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24" >
            <path fill="white" d="M10.705 0C7.54 0 4.902 2.285 4.349 5.291a4.525 4.525 0 0 0-4.107 4.5 4.525 4.525 0 0 0 4.52 4.52h6.761a.625.625 0 1 0 0-1.25H4.761a3.273 3.273 0 0 1-3.27-3.27A3.273 3.273 0 0 1 6.59 7.08a.625.625 0 0 0 .7-1.035 4.488 4.488 0 0 0-1.68-.69 5.223 5.223 0 0 1 5.096-4.104 5.221 5.221 0 0 1 5.174 4.57 4.489 4.489 0 0 0-.488.305.625.625 0 1 0 .731 1.013 3.245 3.245 0 0 1 1.912-.616 3.278 3.278 0 0 1 3.203 2.61.625.625 0 0 0 1.225-.251 4.533 4.533 0 0 0-4.428-3.61 4.54 4.54 0 0 0-.958.105C16.556 2.328 13.9 0 10.705 0zm5.192 10.64a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.054.514c0 .181.018.353.054.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .309-.296c.08-.124.137-.267.173-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.309-.291.917.917 0 0 0-.46-.108zm6.486 0a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.053.514c0 .181.017.353.053.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .31-.296c.078-.124.136-.267.172-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.308-.291.916.916 0 0 0-.461-.108zm-8.537.068l-.84.618.313.43.476-.368v1.877h.603v-2.557zm6.486 0l-.841.618.314.43.477-.368v1.877h.603v-2.557zm-4.435.445c.08 0 .143.028.193.084.05.057.087.127.114.21.026.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.028.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.248.248 0 0 1-.195-.086.584.584 0 0 1-.118-.209 1.245 1.245 0 0 1-.056-.27 2.645 2.645 0 0 1 0-.533c.01-.096.029-.186.056-.27a.583.583 0 0 1 .118-.209.25.25 0 0 1 .195-.084zm6.486 0c.08 0 .144.028.193.084.05.057.087.127.114.21.027.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.027.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.249.249 0 0 1-.195-.086.581.581 0 0 1-.117-.209 1.245 1.245 0 0 1-.056-.27 2.642 2.642 0 0 1 0-.533c.01-.096.028-.186.056-.27a.58.58 0 0 1 .117-.209.25.25 0 0 1 .195-.084zm-2.191 3.51a.93.93 0 0 0-.463.109.908.908 0 0 0-.312.291c-.08.122-.139.263-.175.426a2.383 2.383 0 0 0-.054.514c0 .18.018.353.054.516.036.164.094.308.175.432a.91.91 0 0 0 .312.296.92.92 0 0 0 .463.11c.18 0 .333-.037.46-.11a.892.892 0 0 0 .308-.296 1.32 1.32 0 0 0 .174-.432c.036-.163.054-.335.054-.516 0-.18-.018-.352-.054-.514a1.274 1.274 0 0 0-.174-.426.89.89 0 0 0-.309-.291.918.918 0 0 0-.46-.108zm-6.402.07l-.841.617.314.43.476-.369v1.878h.604v-2.557zm2.125 0l-.841.617.314.43.477-.369v1.878h.603v-2.557zm2.116 0l-.84.617.313.43.477-.369v1.878h.603v-2.557zm2.16.443c.08 0 .144.028.194.085a.605.605 0 0 1 .114.21c.026.083.044.172.053.269a2.639 2.639 0 0 1 0 .532 1.28 1.28 0 0 1-.053.27.585.585 0 0 1-.114.21.244.244 0 0 1-.193.085.25.25 0 0 1-.196-.085.589.589 0 0 1-.117-.21 1.245 1.245 0 0 1-.056-.27 2.597 2.597 0 0 1 0-.532c.01-.097.028-.186.056-.27a.589.589 0 0 1 .117-.209.249.249 0 0 1 .196-.085zm-6.729 3.073a.676.676 0 0 0-.335.078.661.661 0 0 0-.227.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.93.93 0 0 0 .127.313.65.65 0 0 0 .227.215c.092.053.204.08.335.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .225-.215c.057-.09.1-.194.125-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.931.931 0 0 0-.125-.31.658.658 0 0 0-.225-.21.667.667 0 0 0-.334-.08zm3.086 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.907.907 0 0 0-.127.31 1.69 1.69 0 0 0-.04.373c0 .131.013.256.04.375a.928.928 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.752 1.752 0 0 0 0-.748.94.94 0 0 0-.126-.31.657.657 0 0 0-.224-.21.667.667 0 0 0-.334-.08zm5.108 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.931.931 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08.13 0 .243-.027.334-.08a.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.943.943 0 0 0-.126-.31.657.657 0 0 0-.224-.21.668.668 0 0 0-.334-.08zm-6.658.05l-.61.448.227.311.346-.266v1.362h.438v-1.856zm3.068 0l-.61.448.227.311.346-.266v1.362h.438v-1.856zm5.108 0l-.611.448.228.311.346-.266v1.362h.438v-1.856zm-9.712.322c.058 0 .105.02.14.062a.421.421 0 0 1 .083.151.96.96 0 0 1 .04.196 1.932 1.932 0 0 1 0 .386.954.954 0 0 1-.04.197.421.421 0 0 1-.083.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.427.427 0 0 1-.085-.153.887.887 0 0 1-.041-.197 1.96 1.96 0 0 1 0-.386.893.893 0 0 1 .04-.196.42.42 0 0 1 .086-.151.181.181 0 0 1 .141-.062zm3.086 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.94.94 0 0 1 .04.196 1.906 1.906 0 0 1 0 .386.93.93 0 0 1-.04.197.421.421 0 0 1-.082.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.42.42 0 0 1-.086-.153.846.846 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.849.849 0 0 1 .041-.196.42.42 0 0 1 .086-.151.182.182 0 0 1 .141-.062zm5.108 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.92.92 0 0 1 .04.196 1.963 1.963 0 0 1 0 .386.943.943 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.061.18.18 0 0 1-.142-.06.437.437 0 0 1-.085-.153.95.95 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.959.959 0 0 1 .04-.196.47.47 0 0 1 .086-.151.181.181 0 0 1 .142-.062zm-1.684 1.814a.675.675 0 0 0-.336.079.66.66 0 0 0-.227.21.91.91 0 0 0-.127.31 1.731 1.731 0 0 0 0 .748.939.939 0 0 0 .127.314c.059.09.134.162.227.215.093.053.205.08.336.08a.66.66 0 0 0 .334-.08.648.648 0 0 0 .224-.215c.058-.09.1-.195.126-.314a1.737 1.737 0 0 0-.001-.747.928.928 0 0 0-.125-.31.65.65 0 0 0-.224-.211.668.668 0 0 0-.334-.079zm3.063 0a.676.676 0 0 0-.336.079.664.664 0 0 0-.227.21.906.906 0 0 0-.127.31 1.74 1.74 0 0 0 0 .748.936.936 0 0 0 .127.314.66.66 0 0 0 .227.215c.092.053.204.08.336.08a.654.654 0 0 0 .334-.08.648.648 0 0 0 .223-.215c.058-.09.1-.195.126-.314a1.74 1.74 0 0 0 0-.747.928.928 0 0 0-.126-.31.65.65 0 0 0-.223-.211.666.666 0 0 0-.334-.079zm-1.545.05l-.611.448.228.312.346-.267v1.363h.438v-1.856zm-1.518.323c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.91.91 0 0 1 .04.195 1.966 1.966 0 0 1 0 .387.951.951 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.06.18.18 0 0 1-.142-.06.428.428 0 0 1-.085-.152.914.914 0 0 1-.04-.197 1.96 1.96 0 0 1-.011-.195c0-.058.003-.122.01-.192a.923.923 0 0 1 .041-.195c.02-.06.048-.11.085-.152a.181.181 0 0 1 .142-.061zm3.063 0c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.94.94 0 0 1 .04.195 1.91 1.91 0 0 1 0 .387.93.93 0 0 1-.04.197.422.422 0 0 1-.083.152.175.175 0 0 1-.14.06.18.18 0 0 1-.141-.06.423.423 0 0 1-.085-.152.907.907 0 0 1-.04-.197 1.95 1.95 0 0 1 0-.387.915.915 0 0 1 .04-.195c.02-.06.048-.11.085-.152a.182.182 0 0 1 .142-.061zm-9.713.185a.465.465 0 0 0-.232.055.456.456 0 0 0-.157.146.627.627 0 0 0-.089.215 1.168 1.168 0 0 0-.027.259c0 .09.009.177.027.26a.648.648 0 0 0 .089.216c.04.063.093.112.157.149a.459.459 0 0 0 .232.056c.09 0 .168-.02.231-.056a.45.45 0 0 0 .156-.149.67.67 0 0 0 .087-.217 1.218 1.218 0 0 0 0-.518.647.647 0 0 0-.087-.215.448.448 0 0 0-.156-.146.458.458 0 0 0-.23-.055zm1.052.035l-.423.31.158.217.24-.185v.944h.303v-1.286zm-1.052.224c.04 0 .073.014.097.042a.284.284 0 0 1 .057.105.69.69 0 0 1 .028.136c.004.049.007.092.007.133 0 .04-.003.086-.007.135a.684.684 0 0 1-.028.136.285.285 0 0 1-.057.105.123.123 0 0 1-.097.043.125.125 0 0 1-.098-.043.298.298 0 0 1-.059-.105.612.612 0 0 1-.028-.136 1.39 1.39 0 0 1 0-.268.62.62 0 0 1 .028-.136.297.297 0 0 1 .06-.105.125.125 0 0 1 .097-.042zm3.775 1.394a.463.463 0 0 0-.232.054.452.452 0 0 0-.157.146.621.621 0 0 0-.088.214 1.19 1.19 0 0 0 0 .519.641.641 0 0 0 .088.217.46.46 0 0 0 .157.15.458.458 0 0 0 .232.054.454.454 0 0 0 .232-.055.45.45 0 0 0 .155-.149.664.664 0 0 0 .087-.217 1.189 1.189 0 0 0 0-.519.642.642 0 0 0-.087-.214.446.446 0 0 0-.155-.146.459.459 0 0 0-.232-.054zm1.052.034l-.423.31.158.216.24-.185v.945h.303V22.68zm-1.052.223c.04 0 .073.014.098.043a.3.3 0 0 1 .057.105.643.643 0 0 1 .027.135 1.31 1.31 0 0 1 0 .268.654.654 0 0 1-.027.137.307.307 0 0 1-.057.105.124.124 0 0 1-.098.042.125.125 0 0 1-.098-.042.293.293 0 0 1-.059-.105.618.618 0 0 1-.028-.137 1.364 1.364 0 0 1 0-.268.612.612 0 0 1 .028-.135.287.287 0 0 1 .06-.105.123.123 0 0 1 .097-.043z"></path>
        </svg>
    </a>










    <a target="_blank" class="social" title="RSS Feed" href="/posts/index.xml">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280.000000 1280.000000">
            <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentColor">
                <path d="M2295 11929 c-284 -12 -642 -45 -707 -65 -17 -5 -18 -63 -18 -1039 0 -569 4 -1036 8 -1039 5 -3 74 6 153 19 510 86 1168 95 1789 25 1348 -153 2602 -677 3670 -1531 385 -308 820 -744 1126 -1129 842 -1060 1362 -2313 1514 -3650 70 -621 61 -1279 -25 -1789 -13 -79 -22 -148 -19 -153 3 -4 471 -8 1039 -8 l1035 0 5 23 c51 225 85 942 67 1419 -23 605 -77 1044 -198 1617 -294 1400 -927 2734 -1823 3846 -1043 1295 -2364 2259 -3909 2854 -1158 447 -2451 656 -3707 600z"/>
                <path d="M2255 7845 c-269 -25 -620 -81 -667 -106 -17 -9 -18 -55 -18 -899 0 -706 3 -890 13 -890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207 -107 2267 -823 2814 -1902 166 -327 268 -637 330 -1001 38 -227 48 -384 42 -662 -8 -348 -44 -590 -126 -831 -23 -66 -41 -126 -41 -132 0 -10 184 -13 890 -13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782 -59 703 -233 1323 -545 1945 -481 956 -1313 1788 -2270 2268 -620 310 -1239 483 -1940 542 -165 14 -669 10 -840 -5z"/>
                <path d="M2519 3815 c-391 -66 -725 -336 -868 -703 -79 -201 -96 -462 -45 -677 83 -344 338 -641 666 -774 116 -47 205 -69 330 -80 412 -39 811 153 1040 500 193 292 240 648 128 981 -135 403 -492 699 -914 757 -100 14 -241 12 -337 -4z"/>
            </g>
        </svg>
    </a>


    <a target="_blank" class="social" title="Email" href="mailto://0xepitome@gmail.com">
       <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 485.211 485.211">
            <path fill="currentColor" d="M301.393,241.631L464.866,424.56H20.332l163.474-182.928l58.801,51.443L301.393,241.631z M462.174,60.651H23.027 l219.579,192.142L462.174,60.651z M324.225,221.67l160.986,180.151V80.792L324.225,221.67z M0,80.792v321.029L160.972,221.64 L0,80.792z"/>
       </svg>
    </a>





        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2024 . All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="//localhost:1313/posts/ctf-writeups/p3rf3ctr00t/">p3rf3ctr00tCTF official writeup</a>
  </h1>

  <div class="headline">
    <div>
      
      
      <time datetime=" 2024-11-20T00:00:00Z" class="post-date">
        November 20, 2024
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>10 mins read</span>
      </span>
    </div>

    
    <ul class="tags">
      
      <li class="tag-CTF">
        <a href="//localhost:1313/tags/ctf">CTF</a>
      </li>
      
      <li class="tag-Writeups">
        <a href="//localhost:1313/tags/writeups">Writeups</a>
      </li>
      
      <li class="tag-p3rf3ctr00t">
        <a href="//localhost:1313/tags/p3rf3ctr00t">p3rf3ctr00t</a>
      </li>
      
    </ul>
    
  </div>

  
  

  
</div>

  <p>Below are my writeups for all my challenges, I will not be covering welcome and sanity, for sanity you just had to raise a ticket and ask the bot for the flag. The bot responds in some base64 text, decode that and get the flag</p>
<h3 id="insanity-check">Insanity Check</h3>
<p>The aim of this challenge was supposed to be as guessy as possible, hence the name.</p>
<pre tabindex="0"><code>Challenge Description
Author: [0xEpitome](https://x.com/0xEpitome)

Sanity? More Like Insanity

I figured, since you asked me nicely the last time or you did your shenanigans, there are multiple ways to ask me again, no?
It&#39;s Okay If you Don&#39;t 😂

Here is a poem generated by GPT about CTFs

In the realm of cyberspace, **M**astery is key,
**Q**uickly we dive, eager to learn and be free.
With every **K**nowledge gained, we tackle each test,
Joining together, we’ll conquer the quest.

Under pressure we **W**ork, our minds race and spin,
**Y**earning for growth, let the challenge begin!
With tools to e**X**plore, our skills start to shine,
**A**cquiring experience, one victory at a time.

**P**ractice makes perfect, through **CTF** we play,
**L**earning from blunders, we find our own way.
**Z**eroing **(0)** in on the gaps, we strive to improve,
In this vibrant **D**edicated community, we find our groove.

**Q**uestions arise, sparking thoughts deep within,
**R**esilience fuels us; we’re ready to win **;**

**G**rowing with lessons, we take it in pride,
With **H**arnessed experience, we stand side by side.

Let’s **F**oster our passion, keep the fire aglow,
**S**eizing each moment, together we’ll grow.
In this cybersecurity dance, with every adventure,
Let’s take it in stride, embracing our future!


Hint1: Again, It depends on how you ask the bot for what you want!
Hint2: Again, there are ***multiple*** ways of asking the bot!
       Well the bot has said,
       &#34;show them the light&#34; and said something along the lines of,
       &#34;If you are asking me what you need, ask me with that encoding that we all 
       first learnt when starting out.&#34;
       The Bot also insisted on **Be specific!** with what you need and said
       &#34;I can literally respond to one word
Hint3: After being specific and you got my message, right?
       Here is another message from the bot: &#34;Sometimes my words might seem a 
       little off, almost like they&#39;re hiding something... 👀 But hey, who doesn’t 
       love a good secret? They say the best flags are hidden in plain sight. Go 
       ahead, take a closer look—you might find a surprise waiting for you!&#34;

      I heard its called the art of hiding information within another message to   
      avoid detection.
      
      Then maybe just maybe after all the shenanigans, You can read my poem
</code></pre><p>The description literally had everything you need i.e <em><strong>multiple ways</strong></em> so if in the sanity 2 if you asked the bot for &lsquo;flag&rsquo; it sent you a note in <strong>base64</strong> and in the challenge description it said there are multiple ways, how about if we asked the bot for the flag in base64?</p>
<p>If you sent the bot the encoded base64 for flag, Flag or FLAG eg <code>ZmxhZwo=</code>
<img src="20241116125627.png" alt="image"></p>
<p>It sends a very weird text. This is just twitter text steg. In the hint it said something about twitter steg, I found this <a href="https://holloway.nz/steg/" target="_blank">tool</a> for encoding and decoding also.
Copy the first message to decode and you will get this.</p>
<p><img src="20241116134308.png" alt="image"></p>
<p>2nd one!!
<img src="20241116134426.png" alt="image"></p>
<p>If you open the 2 pastebins i.e
<code>pastebin.pl/view/e205c8c5</code>
<code>pastebin.pl/view/b67382bf</code></p>
<p>The first one you will get what you are looking for, Rick Roll!!!
<img src="rickroll-roll.gif" alt="image"></p>
<p>The 2nd one will take you a Gdrive link with a text file with a python code
<img src="20241116135002.png" alt="image"></p>
<p>The script is pretty easy to understand, it takes a a string encoded in base64 and executes it as below:
<img src="20241116135208.png" alt="image"></p>
<p>We see there are 3 functions 1 to print the flag, obviously a lie, 2nd to print a random fact and 3 there&rsquo;s some xor and we are given the hex, well you just need the xor key and try to decode the hex, the key was now in the poem provided in the description, if you observed there were some bolded characters <code>MQKWYXAPCTFLZ(0)DQR;GHFS</code>
Paste this to the code:
<img src="20241116135457.png" alt="image">
Get the Flag
<code>r00t{Vh4t_W4snt_s0_b4d_w4s_IT_cf746daed369deab237423a689181b0da1a71366b6464402ff1d33157701f37c}</code></p>
<h3 id="power-derby">Power Derby</h3>
<p>Here we are given a zip file with the password as <code>infected</code>, this was extracting a PS1 file
<img src="20241119211157.png" alt="image"></p>
<p>The best way to decode a powershell file is to let the script do the heavy lifting, in the code we see an iex (Invoke-Expression). The Invoke-Expression cmdlet returns the output of the expression or command after evaluating or running a given string as a command. A string entered at the command line is echoed or unaltered in the absence of invoke-expression.
The script generally does the following:</p>
<ul>
<li>
<p><strong>Base64 Decoding</strong>: It decodes a Base64-encoded string into binary data.</p>
</li>
<li>
<p><strong>Decompression</strong>: The binary data is decompressed using the Deflate compression algorithm.</p>
</li>
<li>
<p><strong>Stream Reading</strong>: The decompressed data is treated as a stream and read as text using ASCII encoding.</p>
</li>
</ul>
<p>So we can remove the iex cmdlet and assign the rest of the string to a variable
<img src="20241119212457.png" alt="image"></p>
<p>Then we can just ran the variable, to see its contents:
<img src="20241119212611.png" alt="image"></p>
<p>This script is a simple script I copied from <a href="https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters" target="_blank">github</a> that outputs the system information of a machine, apart from the script we see random comments, which are what seem like base64 code, compile them and decode them to see what they are:
Cyberchef is way does it way easier
<img src="20241119213310.png" alt="image"></p>
<p>The decoded base64:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>( $SHELLiD[<span style="color:#ae81ff">1</span>]+$sHELLID[<span style="color:#ae81ff">13</span>]+<span style="color:#e6db74">&#39;X&#39;</span>)( ( [<span style="color:#66d9ef">cHAR[]</span>] (<span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">91</span>,<span style="color:#ae81ff">24</span>,<span style="color:#ae81ff">94</span> , <span style="color:#ae81ff">65</span>,<span style="color:#ae81ff">89</span> , <span style="color:#ae81ff">92</span>,<span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">38</span> , <span style="color:#ae81ff">88</span> , <span style="color:#ae81ff">28</span> ,<span style="color:#ae81ff">28</span> ,<span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">105</span> , <span style="color:#ae81ff">24</span> , <span style="color:#ae81ff">95</span>, <span style="color:#ae81ff">85</span>, <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">38</span> , <span style="color:#ae81ff">29</span> , <span style="color:#ae81ff">74</span>,<span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">85</span> ,<span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">89</span> , <span style="color:#ae81ff">115</span> , <span style="color:#ae81ff">109</span>, <span style="color:#ae81ff">95</span>,<span style="color:#ae81ff">71</span>,<span style="color:#ae81ff">115</span> , <span style="color:#ae81ff">38</span>,<span style="color:#ae81ff">65</span> , <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">115</span>,<span style="color:#ae81ff">20</span> ,<span style="color:#ae81ff">78</span> ,<span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">79</span> , <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">25</span> , <span style="color:#ae81ff">30</span>,<span style="color:#ae81ff">78</span> , <span style="color:#ae81ff">27</span> , <span style="color:#ae81ff">31</span>,<span style="color:#ae81ff">24</span> ,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">78</span>, <span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">25</span>,<span style="color:#ae81ff">79</span>,<span style="color:#ae81ff">73</span>, <span style="color:#ae81ff">72</span> ,<span style="color:#ae81ff">73</span> , <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">77</span>,<span style="color:#ae81ff">74</span> ,<span style="color:#ae81ff">74</span>, <span style="color:#ae81ff">24</span> , <span style="color:#ae81ff">20</span> ,<span style="color:#ae81ff">28</span> , <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">74</span>,<span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">81</span>) 
</span></span><span style="display:flex;"><span>| FoREacH-oBjECt { [<span style="color:#66d9ef">cHAR</span>]($_ <span style="color:#f92672">-BxoR</span> <span style="color:#e6db74">&#34;0x2C&#34;</span> ) } ) -JOin<span style="color:#e6db74">&#39;&#39;</span> )
</span></span></code></pre></div><p>The general purpose of this code, it is performing bitwise xor with the value 0x2c and after applying the bxor the result is converted to a string using [CHAR].  <code>$SHELLID</code> is a predefined PowerShell variable that contains the name of the current shell host, such as <code>ConsoleHost</code></p>
<p>Now to decode back to cyberchef we can copy these values in hex and since we know the key perform the operation, we can have a script in powershell that does the work:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$encoded = @(<span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">94</span>, <span style="color:#ae81ff">65</span>, <span style="color:#ae81ff">89</span>, <span style="color:#ae81ff">92</span>, <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">105</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">95</span>, <span style="color:#ae81ff">85</span>, <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">74</span>, <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">85</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">89</span>, <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">109</span>, <span style="color:#ae81ff">95</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">65</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">78</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">78</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">78</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">73</span>, <span style="color:#ae81ff">72</span>, <span style="color:#ae81ff">73</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">77</span>, <span style="color:#ae81ff">74</span>, <span style="color:#ae81ff">74</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">74</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">81</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$key = 0x2C
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$decodedCharacters = $encoded | ForEach-Object { [<span style="color:#66d9ef">char</span>]($_ <span style="color:#f92672">-bxor</span> $key) }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$decodedString = -join $decodedCharacters
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Write-Host <span style="color:#e6db74">&#34;Flag: </span>$decodedString<span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p>the &lsquo;@&rsquo; allows us to pass multiple parameters to a variable, running it gives us the flag.
<code>{w4rmup_t00_E4sy_1f_y0u_Ask_m3_8b5c6452b7348b95cede504aff4801f9}</code></p>
<p><img src="20241119214539.png" alt="image"></p>
<h3 id="what-the-shell-1">What the Shell 1</h3>
<p><img src="20241118195755.png" alt="image"></p>
<p>This was an easy shellcode challenge which you were provided a .bin file.
Shellcode is well explained in this <a href="https://medium.com/@avaen/extraction-and-analysis-of-injected-shellcode-77445e8b6504" target="_blank">blog</a></p>
<p><img src="20241119215427.png" alt="image"></p>
<p><code>NOTE: Although the files provided for the malware challenges were not harmful, it's always advisable to investigate malware in a controlled environment' </code></p>
<p>In my case I am using <a href="https://github.com/mandiant/flare-vm" target="_blank">Flare VM</a> which comes pre installed with many tools for malware analysis</p>
<p>I recently noted that you can decode shellcode by using python but it&rsquo;s not that clean. So the intended way was to use shellcode tools eg scdbg(shellcode debug) to debug the shellcode. There are many tools that can do it, but scdbg works best for me.</p>
<p>We can clean this shellcode so that we remain with the shellcode only as follows:
<img src="20241119220154.png" alt="image"></p>
<p>I am using Flare Vm for this, in scdbg we need 2 options that is /f which is for the path of the bin file and /s -1 which is for steps until the tool completes.</p>
<p><code>scdbg.exe /f C:\Users\Malware101\Desktop\what_the_shell1\warmup.bin -s -1</code>
<img src="20241119220235.png" alt="image"></p>
<p>The shellcode does execute a cmd prompt which echoes the flag.</p>
<p><code>flag: {w4rmUp_Inn1t_877a6864a9de96dcf07dd99c9d69639a}'</code></p>
<h3 id="what-the-shell-2">What the Shell? 2</h3>
<p><img src="20241118195933.png" alt="image"></p>
<p>For this it was an exe file,</p>
<h4 id="unintented-solve">Unintented Solve</h4>
<p>The easiest way to solve this was through checking the processes created by the file on procmon. Process Monitor(procmon) is an advanced monitoring tool for Windows that shows real-time file system, Registry and process/thread activity.
You can get procmon <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/procmon" target="_blank">here</a></p>
<p>In procmon set filter:
<img src="20241119221243.png" alt="image"></p>
<p>When we run the file, we should see some activity on procmon:
<img src="20241119221407.png" alt="image"></p>
<p>We can see it opens a message box saying &ldquo;Hey, welcome to part two&rdquo;, also in procmon we see activity, going to process tree in procmon:
<img src="20241119221543.png" alt="image"></p>
<p>We see the exe file has 2 sub-processes with the most interesting being powershell child process, in this process:
<img src="20241119221723.png" alt="image"></p>
<p>The following command is being ran on the background:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>powershell.exe -EncodedCommand JABUAGUAbQBwAFAAYQB0AGgAIAA9ACAAWwBTAHkAcwB0AGUAbQAuAEkATwAuAFAAYQB0AGgAXQA6ADoARwBlAHQAVABlAG0AcABQAGEAdABoACgAKQA7ACAAJABGAGkAbABlAFAAYQB0AGgAIAA9ACAAIgAkAFQAZQBtAHAAUABhAHQAaABcAFwAZgBsAGEAZwAuAHQAeAB0ACIAOwAgACIASABlAHIAZQAgAGkAcwAgAHkAbwB1AHIAIABmAGwAYQBnACAAewBBAF8AVgAzAHIAeQBfAE4AMAAxAHMAeQBfAFMAaAA0AGwAbABjADAAZAAzAF8AMwA5AGYANwA3AGUAZgA3ADcAYQA5ADQANQAwADEANgA3ADgAOABkAGUAYgBhADAAOABlADkAZABkADAANAA1ADYAMABjAGEAYwBlAGMAZgAxADcAYgA4ADQANQAyADQAMQBiADcANABjAGMAOQBhAGYANQBkAGUAMQAyAGYAZABkADAANgBmAGQAMwA2ADgAZQA1AGIANwBmADMAYQAyAGIANQA1AGEAMQA1ADYANQAxAGUAMAAxAGQAMwA5ADkAZgBhAGYAMwAzADQANAAyAGIAZgAzADQANAAyADYAZgBhADAAMQA4ADUAOQBhADcANQA0ADIAMAA0AGIAYwA4AH0AIgAgAHwAIABPAHUAdAAtAEYAaQBsAGUAIAAtAEYAaQBsAGUAUABhAHQAaAAgACQARgBpAGwAZQBQAGEAdABoAA==
</span></span></code></pre></div><p>Decoded the base64 code in cyberchef and remove null bytes:
<img src="20241119221922.png" alt="image"></p>
<p>We see the command takes TempPath which is TEMP dir in windows and puts a flag.txt with the note that is our flag.
We can verify this by going to the temp directory and checking the flag.txt to see if we will get our flag.
<img src="image.png" alt="image"></p>
<h4 id="intended-solve">Intended Solve</h4>
<p>For the intended we will use x64dbg to debug our exe file and extract the shellcode.
Most of the shellcodes, they are stored in 3 areas mostly .text, .rsrc and .data sections of a PE file, this can be confirmed in <a href="[Winitor]%28https://www.winitor.com/download%29">pestudio</a>:</p>
<p><img src="20241119222819.png" alt="image"></p>
<p>It is also good to note that, we can also see the functions used by the exe in pestudio:
<img src="20241119222924.png" alt="image"></p>
<p>The flags with x are the most relevant and these functions show the classic pattern of shellcode injection, hence another indicator the exe has a shellcode.</p>
<p>We can extract the shellcode now in x64dbg. in x64dbg go to memory map and look for our executable. Since we already 3 memory regions, we should look for the one with read, write, execute which is the .data section
<img src="20241119224842.png" alt="image"></p>
<p>To dump it we follow it in dump as save it as a .bin file so as to use the scdbg
<img src="20241119224952.png" alt="image"></p>
<p>We can already see hints of powershell encoded command as the one seen on procmon, copy the whole data go to binary, save to a file, I saved mine to flag.bin.</p>
<p>Now we use scdbg as our whattheshell1 code or decoding the powershell and we should get our flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>flag: <span style="color:#f92672">{</span>A_V3ry_N01sy_Sh4llc0d3_39f77ef77a945016788deba08e9dd04560cacecf17b8  
</span></span><span style="display:flex;"><span>45241b74cc9af5de12fdd06fd368e5b7f3a2b55a15651e01d399faf33442bf34426fa01859a754204bc8<span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="hackers-catch">Hackers Catch</h3>
<p><img src="20241118200022.png" alt="image"></p>
<p>The 2 challenges were game rev challenges which their aim was to test the use of the basics of <a href="https://www.cheatengine.org/" target="_blank">Cheat Engine</a></p>
<p>When we run the  game:
<img src="20241119230409.png" alt="image"></p>
<p>We can see a little description that hinted the game was being timed, in this case I made it 10 seconds, so we had 10 seconds to reach a score of 100/100 in order to get the &ldquo;reward&rdquo;.
This is pretty straightforward. Open cheat engine and attach the process to cheat engine.
<img src="20241119230650.png" alt="image"></p>
<p><img src="20241119230837.png" alt="image"></p>
<p>We can enable speedhack and set it to 0 so in laymans terms the game is slowed down, and now we can chase the ball at our own pace with no restriction of time.
<img src="20241119231008.png" alt="image"></p>
<p><code>flag: {G0_4nd_t0uch_gr4ss_0r_else}</code></p>
<h3 id="hackers-catch-2">Hackers Catch 2</h3>
<p><img src="20241118200045.png" alt="image"></p>
<p>This challenge was compiled using godot, the aim of this challenge was to collect 14 flags and the enemy would disappear and we will get to the reward.</p>
<p><img src="20241119231216.png" alt="image"></p>
<p><img src="20241119231233.png" alt="image"></p>
<p>When we get to the 1st enemy:
<img src="20241119231320.png" alt="image"></p>
<p>2nd enemy:
<img src="20241119231345.png" alt="image"></p>
<p>It is also important to note when the enemy was touched a life was decreased, to solve this we needed to use cheat engine to modify the value of the flags to be 14/14 before we reach to the enemy, here is how you can do that:</p>
<p>Attach process to cheat engine:
Now in the scan tab:
<img src="20241119231648.png" alt="image"></p>
<p>We can set the value to 1 since we know the increment of the flags value to be 1 and since it is the first time we are scanning, in the game we collect the first flag and back to cheat engine we click first scan.
<img src="20241119231833.png" alt="image"></p>
<p>This brings many results, so we search for the next pattern which is 2, and we click next scan, we do this until we find the correct address that holds the flag value.
<img src="20241119231937.png" alt="image"></p>
<p>These produced less output which we can monitor. At the 3rd flag, we can start changing the values of the addresses, click on first address and add it to the memory view.
<img src="20241119232107.png" alt="image"></p>
<p>In memory view we can change the value from 3 to 14 now since we found our address
<img src="20241119232222.png" alt="image"></p>
<p>Now when we collect another flag, we should see the flags value change:
<img src="20241119232308.png" alt="image"></p>
<p>Here now we can go and collect our reward:
<img src="20241119232358.png" alt="image"></p>
<p><img src="20241119232427.png" alt="image"></p>
<p><code>flag: {53ri0u5ly_ju5t_g0_0ut5ide_4nd_t0uch_s0me_gr4ss!}</code></p>
<p>I hope you learnt a thing or 2 from the challenges and also enjoyed generally our first CTF.
See you next time!</p>
<p><img src="cheers.webp" alt="image"></p>

  
  <hr>
<div class="footer">
    
	    
            <a class="previous-post" href="//localhost:1313/posts/cryptominer/?ref=footer"><span style="font-weight:bold;">« Previous</span><br>Cryptominer Based Security Events in AWS</a>
        
	    
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#insanity-check">Insanity Check</a></li>
        <li><a href="#power-derby">Power Derby</a></li>
        <li><a href="#what-the-shell-1">What the Shell 1</a></li>
        <li><a href="#what-the-shell-2">What the Shell? 2</a></li>
        <li><a href="#hackers-catch">Hackers Catch</a></li>
        <li><a href="#hackers-catch-2">Hackers Catch 2</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

  

        </div>
    </body>
</html>
